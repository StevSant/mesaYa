# ═══════════════════════════════════════════════════════════════════════════
# mesaYA - Unified Environment Configuration
# ═══════════════════════════════════════════════════════════════════════════
# This is the single source of truth for all environment variables.
# Each service reads from this file or inherits through docker-compose.
#
# Usage:
#   cp .env.template .env
#   # Edit .env with your values
# ═══════════════════════════════════════════════════════════════════════════

# ───────────────────────────────────────────────────────────────────────────
# GENERAL
# ───────────────────────────────────────────────────────────────────────────
TZ=America/Guayaquil
NODE_ENV=development

# ───────────────────────────────────────────────────────────────────────────
# INFRASTRUCTURE - KAFKA (infrastructure/kafka/)
# ───────────────────────────────────────────────────────────────────────────
KAFKA_BROKER=localhost:29092
KAFKA_BROKERS=localhost:29092
KAFKA_VERSION=3.9.0
KAFKA_PORT=9092
KAFKA_EXTERNAL_PORT=29092
KAFKA_CLUSTER_ID=MkU3OEVBNTcwNTJENDM2Qk

# Kafka UI (docker compose --profile ui up)
KAFKA_UI_PORT=8090

# ───────────────────────────────────────────────────────────────────────────
# INFRASTRUCTURE - N8N (infrastructure/n8n/)
# ───────────────────────────────────────────────────────────────────────────
N8N_USER=admin
N8N_PASSWORD=mesaya_n8n_2024
N8N_WEBHOOK_URL=http://localhost:5678/
N8N_LOG_LEVEL=info

# IMPORTANT: Generate unique key for production with: openssl rand -hex 32
N8N_ENCRYPTION_KEY=cambiar_esta_clave_en_produccion_32chars

# MesaYA Services URLs (used by n8n workflows)
MESAYA_API_URL=http://host.docker.internal:3000
MESAYA_GRAPHQL_URL=http://host.docker.internal:8000/graphql
MESAYA_WS_URL=ws://host.docker.internal:8080
MESAYA_CHATBOT_URL=http://host.docker.internal:8001

# ───────────────────────────────────────────────────────────────────────────
# AUTH MICROSERVICE - Database (Supabase - INDEPENDENT DB)
# ───────────────────────────────────────────────────────────────────────────
# IMPORTANT: This is a SEPARATE database from the Gateway/REST service
AUTH_PGHOST=your-auth-project.supabase.co
AUTH_PGPORT=5432
AUTH_PGUSER=postgres
AUTH_PGPASSWORD=your-auth-db-password
AUTH_PGDATABASE=postgres

# Auth MS Kafka config
AUTH_KAFKA_CLIENT_ID=mesa-ya-auth-ms
AUTH_KAFKA_GROUP_ID=mesa-ya-auth-group

# ───────────────────────────────────────────────────────────────────────────
# JWT RS256 ASYMMETRIC KEYS
# ───────────────────────────────────────────────────────────────────────────
# Generate with:
#   openssl genrsa -out private.pem 2048
#   openssl rsa -in private.pem -pubout -out public.pem
#
# PRIVATE KEY (Auth MS only - signs tokens)
# Replace newlines with \n for single-line format
JWT_PRIVATE_KEY="-----BEGIN RSA PRIVATE KEY-----\nYOUR_PRIVATE_KEY_HERE\n-----END RSA PRIVATE KEY-----"

# PUBLIC KEY (Gateway and other services - validates tokens)
JWT_PUBLIC_KEY="-----BEGIN PUBLIC KEY-----\nYOUR_PUBLIC_KEY_HERE\n-----END PUBLIC KEY-----"

# Token expiration settings
JWT_ACCESS_TOKEN_EXPIRES_IN=15m
JWT_REFRESH_TOKEN_EXPIRES_IN=7d

# ───────────────────────────────────────────────────────────────────────────
# GATEWAY/REST SERVICE - Database (Supabase - MAIN DB)
# ───────────────────────────────────────────────────────────────────────────
PGHOST=your-main-project.supabase.co
PGPORT=5432
PGUSER=postgres
PGPASSWORD=your-main-db-password
PGDATABASE=postgres

# Gateway Kafka config
KAFKA_CLIENT_ID=mesa-ya-gateway
KAFKA_GROUP_ID=mesa-ya-gateway-group

# ───────────────────────────────────────────────────────────────────────────
# SECURITY
# ───────────────────────────────────────────────────────────────────────────
AUTH_SALT_ROUNDS=10

# ───────────────────────────────────────────────────────────────────────────
# APPLICATION SETTINGS
# ───────────────────────────────────────────────────────────────────────────
PORT=3000
AUTH_MS_PORT=3001

# ───────────────────────────────────────────────────────────────────────────
# WEBSOCKET SERVICE
# ───────────────────────────────────────────────────────────────────────────
WS_PORT=8080

# ───────────────────────────────────────────────────────────────────────────
# SMTP (Optional - for n8n email workflows)
# ───────────────────────────────────────────────────────────────────────────
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=your_email@gmail.com
# SMTP_PASSWORD=your_app_password
